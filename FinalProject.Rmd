---
title: "358 FinalProject"
author: "Alexa Kelly, Ryan Folks, and Lyndon Swarey"
date: "April 9, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Packages
```{r}
library(tidyverse)
library(cluster)
library(factoextra)
```

## Data
```{r}
# Import data
data_org <- read.csv(".../Downloads/Data/bc_data.csv")

# Create a new file to preserve orgininal data
data <- data_org

# Create New_Id column
data <- data %>% 
  mutate(new_ID = seq(1:569))
```

## Variable clustering: mean

### radius_mean
```{r}
# Select radius_mean
data_3 <- data %>% 
  select(radius_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_3, kmeans, method = "wss") +
  labs(subtitle = "Elbow method: radius_mean")

# Graph for silhouette method
fviz_nbclust(data_3, kmeans, method = "silhouette") +
  labs(subtitle = "Silhouette method: radius mean")

# Kmeans wss method
k_wss <- kmeans(data_3, centers = 3, nstart = 10)

# Kmeans silhouette methos
k_silhouette <- kmeans(data_3, centers = 2, nstart = 10)

# Make new colums in for the new variables generated from kmeans
data_3 <- data_3 %>% 
  mutate(radius_mean_wss = k_wss$cluster,
          radius_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### texture_mean
```{r}
# Select texture_mean
data_4 <- data %>% 
  select(texture_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_4, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: texture_mean")

# Graph for silhouette method
fviz_nbclust(data_4, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhouette method: texture_mean")

# Kmeans wss method
k_wss <- kmeans(data_4, centers = 3, nstart = 10)

# Kmeans silhouette methos
k_silhouette <- kmeans(data_4, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_4 <- data_4 %>% 
  mutate(texture_mean_wss = k_wss$cluster,
          texture_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### perimeter_mean
```{r}
# Select perimeter_mean
data_5 <- data %>% 
  select(perimeter_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_5, kmeans, method = "wss") +
  labs(subtitle = "Elbow method: perimeter_mean")

# Graph for silhouette method
fviz_nbclust(data_5, kmeans, method = "silhouette") +
  labs(subtitle = "Silhouette method: perimeter_mean")

# Kmeans wss method
k_wss <- kmeans(data_5, centers = 3, nstart = 10)

# Kmeans silhouette methos
k_silhouette <- kmeans(data_5, centers = 2, nstart = 10)

# Make new colums in data_3 for the new variables generated from kmeans
data_5 <- data_5 %>% 
  mutate(perimeter_mean_wss = k_wss$cluster,
          perimeter_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### area_mean
```{r}
# Select area_mean
data_6 <- data %>% 
  select(area_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_6, kmeans, method = "wss") +
  labs(subtitle = "Elbow method: area_mean")

# Graph for silhouette method
fviz_nbclust(data_6, kmeans, method = "silhouette") +
  labs(subtitle = "Silhouette method: area_mean")

# Kmeans wss method
k_wss <- kmeans(data_6, centers = 4, nstart = 10)

# Kmeans silhouette methos
k_silhouette <- kmeans(data_6, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_6 <- data_6 %>% 
  mutate(area_mean_wss = k_wss$cluster,
          area_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### smoothness_mean
```{r}
# Select smoothness_mean
data_7 <- data %>% 
  select(smoothness_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_7, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: smoothness_mean")

# Graph for silhouette method
fviz_nbclust(data_7, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: smoothness_mean")

# Kmeans wss method
k_wss <- kmeans(data_7, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_7, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_7 <- data_7 %>% 
  mutate(smoothness_mean_wss = k_wss$cluster,
          smoothness_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### compactness_mean
```{r}
# Select smoothness_mean
data_8 <- data %>% 
  select(compactness_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_8, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: compactness_mean")

# Graph for silhouette method
fviz_nbclust(data_8, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: compactness_mean")

# Kmeans wss method
k_wss <- kmeans(data_8, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_8, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_8 <- data_8 %>% 
  mutate(compactness_mean_wss = k_wss$cluster,
          compactness_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### concavity_mean
```{r}
# Select concavity_mean
data_9 <- data %>% 
  select(concavity_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_9, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: concavity_mean")

# Graph for silhouette method
fviz_nbclust(data_9, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: concavity_mean")

# Kmeans wss method
k_wss <- kmeans(data_9, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_9, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_9 <- data_9 %>% 
  mutate(concavity_mean_wss = k_wss$cluster,
          concavity_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### concave.points_mean
```{r}
# Select concave.points_mean
data_10 <- data %>% 
  select(concave.points_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_10, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: concave.points_mean")

# Graph for silhouette method
fviz_nbclust(data_10, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: concave.points_mean")

# Kmeans wss method
k_wss <- kmeans(data_10, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_10, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_10 <- data_10 %>% 
  mutate(concave.points_mean_wss = k_wss$cluster,
          concave.points_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### symmetry_mean
```{r}
# Select symmetry_mean
data_11 <- data %>% 
  select(symmetry_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_11, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: symmetry_mean")

# Graph for silhouette method
fviz_nbclust(data_11, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: symmetry_mean")

# Kmeans wss method
k_wss <- kmeans(data_11, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_11, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_11 <- data_11 %>% 
  mutate(symmetry_mean_wss = k_wss$cluster,
          symmetry_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### fractal_dimension_mean
```{r}
# Select fractal_dimension_mean
data_12 <- data %>% 
  select(fractal_dimension_mean)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_12, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: fractal_dimension_mean")

# Graph for silhouette method
fviz_nbclust(data_12, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: fractal_dimension_mean")

# Kmeans wss method
k_wss <- kmeans(data_12, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_12, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_12 <- data_12 %>% 
  mutate(fractal_dimension_mean_wss = k_wss$cluster,
          fractal_dimension_mean_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

## Variable clustering: se

### radius_se
```{r}
# Select radius_se
data_13 <- data %>% 
  select(radius_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_13, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: radius_se")

# Graph for silhouette method
fviz_nbclust(data_13, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: radius_se")

# Kmeans wss method
k_wss <- kmeans(data_13, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_13, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_13 <- data_13 %>% 
  mutate(radius_se_wss = k_wss$cluster,
          radius_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### texture_se
```{r}
# Select texture_se
data_14 <- data %>% 
  select(texture_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_14, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: texture_se")

# Graph for silhouette method
fviz_nbclust(data_14, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: texture_se")

# Kmeans wss method
k_wss <- kmeans(data_14, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_14, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_14 <- data_14 %>% 
  mutate(texture_se_wss = k_wss$cluster,
          texture_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### perimeter_se
```{r}
# Select perimeter_se
data_15 <- data %>% 
  select(perimeter_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_15, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: perimeter_se")

# Graph for silhouette method
fviz_nbclust(data_15, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: perimeter_se")

# Kmeans wss method
k_wss <- kmeans(data_15, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_15, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_15 <- data_15 %>% 
  mutate(perimeter_se_wss = k_wss$cluster,
          perimeter_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### area_se
```{r}
# Select area_se
data_16 <- data %>% 
  select(area_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_16, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: area_se")

# Graph for silhouette method
fviz_nbclust(data_16, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: area_se")

# Kmeans wss method
k_wss <- kmeans(data_16, centers = 2, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_16, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_16 <- data_16 %>% 
  mutate(area_se_wss = k_wss$cluster,
          area_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### smoothness_se
```{r}
# Select smoothness_se
data_17 <- data %>% 
  select(smoothness_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_17, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: smoothness_se")

# Graph for silhouette method
fviz_nbclust(data_17, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: smoothness_se")

# Kmeans wss method
k_wss <- kmeans(data_17, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_17, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_17 <- data_17 %>% 
  mutate(smoothness_se_wss = k_wss$cluster,
          smoothness_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### compactness_se
```{r}
# Select compactness_se
data_18 <- data %>% 
  select(compactness_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_18, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: compactness_se")

# Graph for silhouette method
fviz_nbclust(data_18, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: compactness_se")

# Kmeans wss method
k_wss <- kmeans(data_18, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_18, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_18 <- data_18 %>% 
  mutate(compactness_se_wss = k_wss$cluster,
          compactness_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### concavity_se
```{r}
# Select concavity_se
data_19 <- data %>% 
  select(concavity_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_19, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: concavity_se")

# Graph for silhouette method
fviz_nbclust(data_19, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: concavity_se")

# Kmeans wss method
k_wss <- kmeans(data_19, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_19, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_19 <- data_19 %>% 
  mutate(concavity_se_wss = k_wss$cluster,
          concavity_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### concave.points_se
```{r}
# Select concave.points_se
data_20 <- data %>% 
  select(concave.points_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_20, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: concave.points_se")

# Graph for silhouette method
fviz_nbclust(data_20, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: concave.points_se")

# Kmeans wss method
k_wss <- kmeans(data_20, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_20, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_20 <- data_20 %>% 
  mutate(concave.points_se_wss = k_wss$cluster,
          concave.points_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### symmetry_se
```{r}
# Select symetry_se
data_21 <- data %>% 
  select(symmetry_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_21, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: symmetry_se")

# Graph for silhouette method
fviz_nbclust(data_21, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: symmetry_se")

# Kmeans wss method
k_wss <- kmeans(data_21, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_21, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_21 <- data_21 %>% 
  mutate(symmetry_se_wss = k_wss$cluster,
          symmetry_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### fractal_dimension_se
```{r}
# Select fractal_dimension_mean
data_22 <- data %>% 
  select(fractal_dimension_se)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_22, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: fractal_dimension_se")

# Graph for silhouette method
fviz_nbclust(data_22, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: fractal_dimension_se")

# Kmeans wss method
k_wss <- kmeans(data_22, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_22, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_22 <- data_22 %>% 
  mutate(fractal_dimension_se_wss = k_wss$cluster,
          fractal_dimension_se_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

## Variable clustering: worst

### radius_worst
```{r}
# Select radius_worst
data_23 <- data %>% 
  select(radius_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_23, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: radius_worst")

# Graph for silhouette method
fviz_nbclust(data_23, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: radius_worst")

# Kmeans wss method
k_wss <- kmeans(data_23, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_23, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_23 <- data_23 %>% 
  mutate(radius_worst_wss = k_wss$cluster,
          radius_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


### texture_worst
```{r}
# Select texture_worst
data_24 <- data %>% 
  select(texture_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_24, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: texture_worst")

# Graph for silhouette method
fviz_nbclust(data_24, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: texture_worst")

# Kmeans wss method
k_wss <- kmeans(data_24, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_24, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_24 <- data_24 %>% 
  mutate(texture_worst_wss = k_wss$cluster,
          texture_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


### perimeter_worst
```{r}
# Select perimeter_worst
data_25 <- data %>% 
  select(perimeter_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_25, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: perimeter_worst")

# Graph for silhouette method
fviz_nbclust(data_25, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method:perimeter_worst")

# Kmeans wss method
k_wss <- kmeans(data_25, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_25, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_25 <- data_25 %>% 
  mutate(perimeter_worst_wss = k_wss$cluster,
          perimeter_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


### area_worst
```{r}
# Select area_worst
data_26 <- data %>% 
  select(area_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_26, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: area_worst")

# Graph for silhouette method
fviz_nbclust(data_26, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: area_worst")

# Kmeans wss method
k_wss <- kmeans(data_26, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_26, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_26 <- data_26 %>% 
  mutate(area_worst_wss = k_wss$cluster,
          area_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


### smoothness_worst
```{r}
# Select smoothness_worst
data_27 <- data %>% 
  select(smoothness_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_27, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: smoothness_worst")

# Graph for silhouette method
fviz_nbclust(data_27, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: smoothness_worst")

# Kmeans wss method
k_wss <- kmeans(data_27, centers = 4, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_27, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_27 <- data_27 %>% 
  mutate(smoothness_worst_wss = k_wss$cluster,
          smoothness_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


### compactness_worst
```{r}
# Select compactness_worst
data_28 <- data %>% 
  select(compactness_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_28, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: compactness_worst")

# Graph for silhouette method
fviz_nbclust(data_28, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: compactness_worst")

# Kmeans wss method
k_wss <- kmeans(data_28, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_28, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_28 <- data_28 %>% 
  mutate(compactness_worst_wss = k_wss$cluster,
          compactness_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


### concavity_worst
```{r}
# Select radius_worst
data_29 <- data %>% 
  select(concavity_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_29, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: concavity_worst")

# Graph for silhouette method
fviz_nbclust(data_29, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: concavity_worst")

# Kmeans wss method
k_wss <- kmeans(data_29, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_29, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_29 <- data_29 %>% 
  mutate(concavity_worst_wss = k_wss$cluster,
          concavity_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### concave.points_worst
```{r}
# Select concave.points_worst
data_30 <- data %>% 
  select(concave.points_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_30, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: concave.points_worst")

# Graph for silhouette method
fviz_nbclust(data_30, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: concave.points_worst")

# Kmeans wss method
k_wss <- kmeans(data_30, centers = 3, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_30, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_30 <- data_30 %>% 
  mutate(concave.points_worst_wss = k_wss$cluster,
          concave.points_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### symmetry_worst
```{r}
# Select radius_worst
data_31 <- data %>% 
  select(symmetry_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_31, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: symmetry_worst")

# Graph for silhouette method
fviz_nbclust(data_31, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: symmetry_worst")

# Kmeans wss method
k_wss <- kmeans(data_31, centers = 4, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_31, centers = 8, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_31 <- data_31 %>% 
  mutate(symmetry_worst_wss = k_wss$cluster,
          symmetry_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```

### fractal_dimension_worst
```{r}
# Select radius_worst
data_32 <- data %>% 
  select(fractal_dimension_worst)

# Set seed
set.seed(123)

# Graph for wws method
fviz_nbclust(data_32, kmeans, method = "wss") + 
  labs(subtitle = "Elbow method: fractal_dimension_worst")

# Graph for silhouette method
fviz_nbclust(data_32, kmeans, method = "silhouette") + 
  labs(subtitle = "Silhoutte method: fractal_dimension_worst")

# Kmeans wss method
k_wss <- kmeans(data_32, centers = 4, nstart = 10) 

# Kmeans silhouette methos
k_silhouette <- kmeans(data_32, centers = 2, nstart = 10)

# Make new colums for the new variables generated from kmeans
data_32 <- data_32 %>% 
  mutate(fractal_dimension_worst_wss = k_wss$cluster,
          fractal_dimension_worst_sil = k_silhouette$cluster,
          new_ID = seq(1:569))
```


```{r}
#Select the first 2 row the data file
data_new <- data %>% 
  select(c(1,2,33))

# Make a merge function
mymerge <- function(x, y){
  df <- merge(x, y, by= "new_ID", all.x= TRUE, all.y= TRUE)
  return(df)}

# Merge files
data_new <-Reduce(mymerge, list(data_new, data_3,data_4, data_5, data_6,
                               data_7, data_8, data_9, data_10, data_11,
                               data_12, data_13, data_14, data_15, data_16,
                               data_17, data_18, data_19, data_20, data_21,
                               data_22, data_23, data_24, data_25, data_26,
                               data_27, data_28, data_29, data_30, data_31, data_32))

# Arrange the columns
data_new <- data_new[c(1,2,3,4,7,10,13,16,19,22,25,28,
                         31,34,37,40,43,46,49,52,55,58,
                         61,64,67,70,73,76,79,82,85,88,
                         91,5,8,11,14,17,20,23,26,29,
                         32,35,38,41,44,47,50,53,56,59,
                         62,65,68,71,74,77,80,83,86,89,92,6,
                       9,12,15,18,21,24,27,30,33,36,39,42,45,
                       48,51,54,57,60,63,66,69,72,75,78,81,
                       84,87,90,93)]
data_chisquare <- data_new %>%
  select(c(34:93,3))

  

myTests <- lapply(data_chisquare[-length(data_chisquare)], function(x) chisq.test(table(as.factor(x), data_chisquare$diagnosis)))
unlist(sapply(myTests, "[", "p.value"))

```

```{r}
colnames(data)

```
